"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[5969],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=p(n),h=i,g=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return n?a.createElement(g,s(s({ref:t},c),{},{components:n})):a.createElement(g,s({ref:t},c))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,s=new Array(r);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,s[1]=o;for(var p=2;p<r;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},65979:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return p},assets:function(){return c},toc:function(){return u},default:function(){return h}});var a=n(87462),i=n(63366),r=(n(67294),n(3905)),s=["components"],o={slug:"openadmin",title:"HTB OpenAdmin writeup",image:"/img/HTB/openadmin.png",authors:["shivam"],tags:["openadmin","rce","ssh2john","nano"]},l="openAdmin",p={permalink:"/Cybernotes/blog/openadmin",source:"@site/blog/2022-02-26-OpenAdmin/openAdmin.md",title:"HTB OpenAdmin writeup",description:"nmap results",date:"2022-02-26T00:00:00.000Z",formattedDate:"February 26, 2022",tags:[{label:"openadmin",permalink:"/Cybernotes/blog/tags/openadmin"},{label:"rce",permalink:"/Cybernotes/blog/tags/rce"},{label:"ssh2john",permalink:"/Cybernotes/blog/tags/ssh-2-john"},{label:"nano",permalink:"/Cybernotes/blog/tags/nano"}],readingTime:2.56,truncated:!0,authors:[{name:"0xSH1V4M",title:"Author",url:"https://github.com/shivam1317",imageURL:"https://avatars.githubusercontent.com/u/70281451?v=4",key:"shivam"}],frontMatter:{slug:"openadmin",title:"HTB OpenAdmin writeup",image:"/img/HTB/openadmin.png",authors:["shivam"],tags:["openadmin","rce","ssh2john","nano"]},prevItem:{title:"THM Gamingserver writeup",permalink:"/Cybernotes/blog/gamingserver"},nextItem:{title:"THM Road writeup",permalink:"/Cybernotes/blog/road"}},c={authorsImageUrls:[void 0]},u=[{value:"nmap results",id:"nmap-results",children:[],level:2},{value:"dirsearch results",id:"dirsearch-results",children:[],level:2},{value:"Exploitation",id:"exploitation",children:[],level:2},{value:"User Privesc",id:"user-privesc",children:[],level:2},{value:"Root Privesc",id:"root-privesc",children:[],level:2}],d={toc:u};function h(e){var t=e.components,o=(0,i.Z)(e,s);return(0,r.kt)("wrapper",(0,a.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(86608).Z,width:"1155",height:"635"})),(0,r.kt)("h2",{id:"nmap-results"},"nmap results"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"PORT STATE SERVICE VERSION\n22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n| 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)\n| 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf\ud83c\udde9\ud83c\uddeabd:6c:7a:54 (ECDSA)\n|","_"," 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)\n80/tcp open http Apache httpd 2.4.29 ((Ubuntu))\n|","_","http-server-header: Apache/2.4.29 (Ubuntu)\n|","_","http-title: Apache2 Ubuntu Default Page: It works\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"dirsearch-results"},"dirsearch results"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"[09:58:05] 301 -  314B  - /artwork  ->  http://10.10.10.171/artwork/\n[09:58:18] 200 -   11KB - /index.html\n[09:58:23] 301 -  312B  - /music  ->  http://10.10.10.171/music/\n[09:58:31] 403 -  277B  - /server-status\n")),(0,r.kt)("hr",null),(0,r.kt)("p",null,"--\x3e got this website at /artwork directory"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(17059).Z,width:"1825",height:"809"})),(0,r.kt)("p",null,"--\x3e i searched for many things but didn't get anything !"),(0,r.kt)("p",null,"==> so i went to /music directory and i found another website there"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(56685).Z,width:"1885",height:"755"})),(0,r.kt)("p",null,"--\x3e when i clicked on login page i got something like this"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(10446).Z,width:"1255",height:"503"})),(0,r.kt)("p",null,"--\x3e so the openadmin version is ",(0,r.kt)("inlineCode",{parentName:"p"},"v18.1.1")," so Let's search exploit for it !"),(0,r.kt)("p",null,"--\x3e and i got one on github and exploit-db"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(16423).Z,width:"1269",height:"671"})),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"exploitation"},"Exploitation"),(0,r.kt)("p",null,"--\x3e so i installed the python file which was on github and first run this command"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"python3 ona-rce.py check <url>\n")),(0,r.kt)("p",null,"--\x3e and i got this text"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(54646).Z,width:"819",height:"155"})),(0,r.kt)("p",null,"--\x3e so remote host is vulnerable so Let's exploit it"),(0,r.kt)("p",null,"--\x3e and i got shell !"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(1174).Z,width:"853",height:"233"})),(0,r.kt)("p",null,"--\x3e after many search i got the database config file in /opt/ona/www/local/config"),(0,r.kt)("p",null,"--\x3e and i found the password but we don't know whose password it is so i tried this password on both and got the ssh shell of jimmy user !"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(12643).Z,width:"1201",height:"607"})),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"user-privesc"},"User Privesc"),(0,r.kt)("p",null,"--\x3e i got one file at /var/www/internal which says"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'Don\'t forget your "ninja" password\n')),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(35500).Z,width:"1203",height:"293"})),(0,r.kt)("p",null,"--\x3e i did ",(0,r.kt)("inlineCode",{parentName:"p"},"netstat -anp")," and found one port which was running internally"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(29390).Z,width:"1459",height:"603"})),(0,r.kt)("p",null,"--\x3e also i found some files at /var/www/internal"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(6028).Z,width:"717",height:"187"})),(0,r.kt)("p",null,"--\x3e i got the username as jimmy and password hash in ",(0,r.kt)("inlineCode",{parentName:"p"},"index.php")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(43033).Z,width:"1909",height:"319"})),(0,r.kt)("p",null,"--\x3e after decoding that hash i got the password"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(95668).Z,width:"1211",height:"429"})),(0,r.kt)("p",null,"--\x3e so i found that the main.php file is executing the command to display the id_rsa key for joanna so we have to display that page anyway so we can get it !"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(12883).Z,width:"1243",height:"293"})),(0,r.kt)("p",null,"--\x3e so i used curl command to get the resquest page of internal server which was running at port 52843"),(0,r.kt)("p",null,"--\x3e command which i used :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"curl -u jimmy:Revealed http://127.0.0.1:52843/main.php\n")),(0,r.kt)("p",null,"--\x3e and i got the id_rsa key !"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(77946).Z,width:"1287",height:"699"})),(0,r.kt)("p",null,"--\x3e but it's encrypted so Let's decrypt it first using ssh2john and john"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(53529).Z,width:"1233",height:"623"})),(0,r.kt)("p",null,"--\x3e after that i got passphrase to login and after that i got joanna's SSH shell !"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"root-privesc"},"Root Privesc"),(0,r.kt)("p",null,"--\x3e after getting logged in first i done ",(0,r.kt)("inlineCode",{parentName:"p"},"sudo -l")," and found this :"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(4367).Z,width:"964",height:"241"})),(0,r.kt)("p",null,"--\x3e so i searched for it on github and got this command :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"nano\n^R^X (here ^ means ctrl)\nreset; sh 1>&0 2>&0\n")),(0,r.kt)("p",null,"--\x3e and after that i got root shell !"),(0,r.kt)("p",null,"--\x3e but it was not stable so i got the reverse shell with pwncat and got stable root shell !"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(85961).Z,width:"962",height:"707"})),(0,r.kt)("hr",null))}h.isMDXComponent=!0},17059:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716101117-b99246408136503b5f2e5e2040052951.png"},56685:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716101253-11b6993be5ad200ab44b7d11717f7b0d.png"},10446:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716101329-241420fee6fc644d1029eb4058c06628.png"},16423:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716101422-92834560101c97a35071ac664d71cc2a.png"},54646:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716101630-9a58561165442c830dac17dddce610b1.png"},1174:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716101740-bad3c483cdb0a3354f5707f01930e2a8.png"},12643:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716112150-dc43d8b69b9d50bec2e5671a1a6ef69b.png"},35500:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716121615-574412fd7d7f93cab90a1a7c4ef0c8d0.png"},29390:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716124451-eab938e523533897d9db3a608675365f.png"},53529:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716125317-e6775f947df8169d37c3c25b1c096151.png"},77946:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716125347-7cc516aa635c7ef531e7f4e8308bb5c7.png"},12883:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716125406-e585052635221794fdc60bf93ecfcace.png"},6028:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716125435-6c93027e7e1789efe73f3de1d897d158.png"},43033:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716125512-2391b80de6ad393d5b5e1be89700e0dd.png"},95668:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716125550-6849393f71c1753c942cd5b7adebff4a.png"},4367:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716131528-ad8f3e30e79945cf0679a03372a0cb32.png"},85961:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210716131716-792fadcca353ae17e0b56162f95568bd.png"},86608:function(e,t,n){t.Z=n.p+"assets/images/openadmin-34ce8055c962e2c065c6916ba4a5004d.png"}}]);