"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[7280],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),u=i,g=d["".concat(l,".").concat(u)]||d[u]||h[u]||r;return n?a.createElement(g,o(o({ref:t},c),{},{components:n})):a.createElement(g,o({ref:t},c))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},94140:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},assets:function(){return c},toc:function(){return h},default:function(){return u}});var a=n(87462),i=n(63366),r=(n(67294),n(3905)),o=["components"],s={title:"VishwaCTF 2022 writeups",description:"VishwaCTF 2022 web,osint,crypto and forensics challenge writeups",authors:["shivam"],image:"/img/ctftime/vishwactf2022.png",slug:"vishwactf2022",tags:["web","OSINT","forensics","crypto"]},l=void 0,p={permalink:"/Cybernotes/blog/vishwactf2022",source:"@site/blog/2022-03-21-vishwaCTF2022/writeup.md",title:"VishwaCTF 2022 writeups",description:"VishwaCTF 2022 web,osint,crypto and forensics challenge writeups",date:"2022-03-21T00:00:00.000Z",formattedDate:"March 21, 2022",tags:[{label:"web",permalink:"/Cybernotes/blog/tags/web"},{label:"OSINT",permalink:"/Cybernotes/blog/tags/osint"},{label:"forensics",permalink:"/Cybernotes/blog/tags/forensics"},{label:"crypto",permalink:"/Cybernotes/blog/tags/crypto"}],readingTime:5.135,truncated:!0,authors:[{name:"0xSH1V4M",title:"Author",url:"https://github.com/shivam1317",imageURL:"https://avatars.githubusercontent.com/u/70281451?v=4",key:"shivam"}],frontMatter:{title:"VishwaCTF 2022 writeups",description:"VishwaCTF 2022 web,osint,crypto and forensics challenge writeups",authors:["shivam"],image:"/img/ctftime/vishwactf2022.png",slug:"vishwactf2022",tags:["web","OSINT","forensics","crypto"]},nextItem:{title:"THM Dejavu writeup",permalink:"/Cybernotes/blog/dejavu"}},c={authorsImageUrls:[void 0]},h=[{value:"Intro",id:"intro",children:[],level:2},{value:"web",id:"web",children:[{value:"Request me FLAG",id:"request-me-flag",children:[],level:3},{value:"Keep your secrets",id:"keep-your-secrets",children:[],level:3},{value:"strong encryption",id:"strong-encryption",children:[],level:3}],level:2},{value:"Cryptography",id:"cryptography",children:[{value:"John the Rocker",id:"john-the-rocker",children:[],level:3}],level:2},{value:"Forensics",id:"forensics",children:[{value:"So grateful",id:"so-grateful",children:[],level:3}],level:2},{value:"OSINT",id:"osint",children:[{value:"Rocket Raccoon",id:"rocket-raccoon",children:[],level:3}],level:2},{value:"Conclusion",id:"conclusion",children:[],level:2}],d={toc:h};function u(e){var t=e.components,s=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"intro"},"Intro"),(0,r.kt)("p",null,"VishwaCTF 2022 was Fun CTF challenge. me and my team participated in it as ",(0,r.kt)("inlineCode",{parentName:"p"},"W3 4R3 N00BS")," team and we got top 100 in this CTF. ofcourse it's not a good rank because we don't have any forensics,crypto and reversing players and also their OSINT and stegno challenges were only related to guesswork. that's why we were able to do only 1 OSINT challenge. If you are interested in joining our team then contact us through our ",(0,r.kt)("a",{parentName:"p",href:"https://discord.gg/2KJJMQ8DRP"},"discord server")),(0,r.kt)("p",null,"This is the scoreboard for our team."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://cdn.discordapp.com/attachments/833787171130834951/955090566348152902/unknown.png",alt:null})),(0,r.kt)("p",null,"--\x3e I solved 11 challenges from my team. And in total our team have solved 18 challenges."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(79744).Z,width:"1657",height:"575"})),(0,r.kt)("p",null,"These are the writeups for challenges which i solved."),(0,r.kt)("h2",{id:"web"},"web"),(0,r.kt)("h3",{id:"request-me-flag"},"Request me FLAG"),(0,r.kt)("p",null,"So first of all if we go to main page then we will see this 404 page. This page is not really 404 but it's there just as rabbit hole."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(21265).Z,width:"1427",height:"937"})),(0,r.kt)("p",null,"So it says request me so i tried to do things like going to ",(0,r.kt)("inlineCode",{parentName:"p"},"flag.php")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"home.php")," but i haven't got anything."),(0,r.kt)("p",null,"I also tried to find parameteres for this ",(0,r.kt)("inlineCode",{parentName:"p"},"404.php")," file but no luck :("),(0,r.kt)("p",null,"And after some time i again read the challenge description and i realized that it says ",(0,r.kt)("inlineCode",{parentName:"p"},"request me")," so maybe what if we change the request method from ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"FLAG"),"?"),(0,r.kt)("p",null,"So let's try this!"),(0,r.kt)("p",null,"i intercepted the request and changed request method to ",(0,r.kt)("inlineCode",{parentName:"p"},"FLAG")," like this:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(41035).Z,width:"1857",height:"821"})),(0,r.kt)("p",null,"But i didn't found anything. but wait! let's try this method for ",(0,r.kt)("inlineCode",{parentName:"p"},"/")),(0,r.kt)("p",null,"And boom i got the flag!"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(35418).Z,width:"1799",height:"627"})),(0,r.kt)("h3",{id:"keep-your-secrets"},"Keep your secrets"),(0,r.kt)("p",null,"--\x3e In this challenge we have one api with GET method route which is ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/signup/{username}")," and POST method route which is ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/login/user")," with token in header"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(79526).Z,width:"1325",height:"517"})),(0,r.kt)("p",null,"But what's token here? So let's first try to register a user and let's name it ",(0,r.kt)("inlineCode",{parentName:"p"},"admin")),(0,r.kt)("p",null,"so i intercepted the request and registereed a user and i got one jwt token."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(12809).Z,width:"1767",height:"593"})),(0,r.kt)("p",null,"And token looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2NDc4NDgyMjV9.nl2_Vz9Vq5cfmhssnV_djgGGJ09f3KpCf_hMxu18jsY\n")),(0,r.kt)("p",null,"So let's goto ",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io/"},"jwt.io")," and check this token"),(0,r.kt)("p",null,"And i found that there is 3 fields in token: ",(0,r.kt)("inlineCode",{parentName:"p"},"username"),",",(0,r.kt)("inlineCode",{parentName:"p"},"role")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"iat")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(3675).Z,width:"1425",height:"749"})),(0,r.kt)("p",null,"So now let's check the POST route which says it's only accessible by admins and it's asking for a token. So maybe if we can change the ",(0,r.kt)("inlineCode",{parentName:"p"},"role")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"admin")," in jwt token and pass it in ",(0,r.kt)("inlineCode",{parentName:"p"},"token")," header then we can access this page!"),(0,r.kt)("p",null,"So for that first we need to crack the secret for this jwt."),(0,r.kt)("p",null,"And i found it with john the ripper tool."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://cdn.discordapp.com/attachments/898560816457072691/955016432796725269/unknown.png",alt:null})),(0,r.kt)("p",null,"So now we just have to use this secret to sign our jwt token which have admin as role and then just pass it in token header!"),(0,r.kt)("p",null,"So after changing required fields, jwt token looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNjQ3ODQ4MjI1fQ.7oOS5McgiZO-TZx3aIMB8u4XkcOA98MlmYPxFKk6N7Y\n")),(0,r.kt)("p",null,"So now let's just pass it through headers in POST route."),(0,r.kt)("p",null,"Request:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(88933).Z,width:"1920",height:"661"})),(0,r.kt)("p",null,"Response:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(64382).Z,width:"1047",height:"415"})),(0,r.kt)("p",null,"And we got our flag : ",(0,r.kt)("inlineCode",{parentName:"p"},"vishwactf{w3@k_$ecr3t$}")),(0,r.kt)("h3",{id:"strong-encryption"},"strong encryption"),(0,r.kt)("p",null,"--\x3e This challenge was more like reversing the encryption. so going to the page gives us this php code which have encryption function and we have given one encrypted flag and we have to decrypt it by analysing this encryption method!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"}," <?php //\xa0Decrypt\xa0->\xa0576e78697e65445c4a7c8033766770357c3960377460357360703a6f6982452f12f4712f4c769a75b33cb995fa169056168939a8b0b28eafe0d724f18dc4a7 $flag=\"\";\n\n\xa0\xa0\xa0\xa0function encrypt($str,$enKey){ $strHex=''; $Key=''; $rKey=69; $tmpKey='';\n\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for($i=0;$i<strlen($enKey);$i++){ $Key.=ord($enKey[$i])+$rKey; $tmpKey.=chr(ord($enKey[$i])+$rKey);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0} $rKeyHex=dechex($rKey); $enKeyHash = hash('sha256',$tmpKey);\n\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0($i=0,$j=0; $i < strlen($str); $i++,$j++){\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if($j==strlen($Key)){ $j=0;\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0} $strHex .= dechex(ord($str[$i])+$Key[$j]);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0} $encTxt = $strHex.$rKeyHex.$enKeyHash;\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0return $encTxt;\n\xa0\xa0\xa0\xa0} $encTxt = encrypt($flag, \"VishwaCTF\");\n\n\xa0\xa0\xa0\xa0echo $encTxt;\n\n?>\n")),(0,r.kt)("p",null,"So i made this script for decrypting the flag:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n\n$flag = "576e78697e65445c4a7c8033766770357c3960377460357360703a6f6982";\n$key = "155174184173188166136153139";\n\n$finalflag = \'\';\n\nfor($i=0,$j=0;$i<strlen($flag);$i+=2,$j++){\n    if($j==strlen($key)){\n        $j=0;\n    }\n    $temp = $flag[$i].$flag[$i+1];\n    $dectemp = hexdec($temp);\n    $dectemp = $dectemp - $key[$j];\n    $chrtemp = chr($dectemp);\n    $finalflag .= $chrtemp;\n}\necho $finalflag;\n\n?>\n')),(0,r.kt)("p",null,"And i got the flag: ",(0,r.kt)("inlineCode",{parentName:"p"},"VishwaCTF{y0u_h4v3_4n_0p_m1nd}")),(0,r.kt)("h2",{id:"cryptography"},"Cryptography"),(0,r.kt)("h3",{id:"john-the-rocker"},"John the Rocker"),(0,r.kt)("p",null,"--\x3e In this challenge, we have one ",(0,r.kt)("inlineCode",{parentName:"p"},"id_rsa")," which have a passphrase and we have to decrypt it to get the flag. We can do this using ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/openwall/john/blob/bleeding-jumbo/run/ssh2john.py"},"ssh2john")),(0,r.kt)("p",null,"First convert this id_rsa file to john readable format using ssh2john"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ssh2john.py id_rsa > converted\n")),(0,r.kt)("p",null,"After that use john the ripper tool to crack the passphrase for this id_rsa"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"john --wordlist=/usr/share/wordlists/rockyou.txt converted\n")),(0,r.kt)("p",null,"And we got our flag!"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(79643).Z,width:"1339",height:"443"})),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"vishwactf{!!**john**!!}")),(0,r.kt)("h2",{id:"forensics"},"Forensics"),(0,r.kt)("h3",{id:"so-grateful"},"So grateful"),(0,r.kt)("p",null,"--\x3e In this challenge, we have one pcap file in which we have to find the password. so let's analyse it using ",(0,r.kt)("a",{parentName:"p",href:"https://www.wireshark.org/"},"wireshark")),(0,r.kt)("p",null,"And after analysing the tcp streams i found password in 5th TCP stream which looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"POST /pages/main.html HTTP/1.1\nReferer: 10.0.0.1:8080/index.html\nUser-Agent: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9*/*;q=0.8\nHost: 10.0.0.1:8080\nConnection: Keep-Alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 41\nAccept-Language: en-US,en;q=0.5\n\nuserid=spiveyp&pswrd=S04xWjZQWFZ5OQ%3D%3DHTTP/1.0 200 OK\nServer: BaseHTTP/0.3 Python/2.7.9\nDate: Sat, 19 Mar 2016 02:12:42 GMT\nContent-type: text/html\n")),(0,r.kt)("p",null,"And after decoding the password with ",(0,r.kt)("inlineCode",{parentName:"p"},"URL->base64")," i found the flag!"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"vishwactf{KN1Z6PXVy9}")),(0,r.kt)("h2",{id:"osint"},"OSINT"),(0,r.kt)("h3",{id:"rocket-raccoon"},"Rocket Raccoon"),(0,r.kt)("p",null,"Challenge description was like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Who is 'racckoonn' exactly? Intel has that their owner has leaked some private information.\n")),(0,r.kt)("p",null,"--\x3e So i googled for it but didn't found anything relatable. So after that i guessed that it can be a username so i used ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/sherlock-project/sherlock"},"sherlock")," to find the accounts for that username."),(0,r.kt)("p",null,"And i found many accounts but instagram looks interesting!"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(74848).Z,width:"1345",height:"413"})),(0,r.kt)("p",null,"And i found ",(0,r.kt)("a",{parentName:"p",href:"https://www.instagram.com/racckoonn/"},"this")," account in which i found one more interesting thing!"),(0,r.kt)("p",null,"I found this caption in one of the post:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Check out my mum's new YouTube channel!\nhttps://www.youtube.com/channel/UCDurVPcUypifNkJVrHxJ3vQ\n")),(0,r.kt)("p",null,"So After going there i found one more username as ",(0,r.kt)("inlineCode",{parentName:"p"},"JohnsonM3llisa")," So i used sherlock on this also!"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(1211).Z,width:"1233",height:"403"})),(0,r.kt)("p",null,"And boom i found twitter account!"),(0,r.kt)("p",null,"After going there i found one tweet :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"OOPS! Almost leaked some private information, hope there is no way to get it back haha\n")),(0,r.kt)("p",null,"So maybe they deleted the private info and there is a one way to see deleted info from social media accounts which is ",(0,r.kt)("a",{parentName:"p",href:"https://archive.org/web/"},"waybackmachine")),(0,r.kt)("p",null,"So i went there and pasted their twitter profile link and found the flag!"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(96073).Z,width:"957",height:"183"})),(0,r.kt)("p",null,"And we found the flag : ",(0,r.kt)("inlineCode",{parentName:"p"},"Vishwactf{R4cc00ns_4r3_Sm4rt}")),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"--\x3e All web challenges were fun but i didn't liked their OSINT,misc and stegnography challenges because there were too many guesswork to do."),(0,r.kt)("p",null,"Thanks for reading. :)"))}u.isMDXComponent=!0},21265:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321032855-3f6402459b9f1f9b0db2dedf361ad131.png"},41035:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321033308-93c59431cdbf8b00c6b468549dd90ed1.png"},35418:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321033404-b624d2341627b9cdebb3dd564c9cfba2.png"},79526:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321033546-fd8d35a349cd77ee026440d3c743c0c4.png"},12809:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321033745-94fbf5fcfb27a919b705f404107ff44e.png"},3675:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321033932-0449ebba9950d8eee98bd62a72733fc4.png"},88933:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321034503-91c8ce0e3469b9bea5403f5386fb7655.png"},64382:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321034517-adb6f7e7decc6ce49ca43ce990f2c407.png"},79643:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321035246-ceea09c8c9c3a3c9982b6e69b6667fe9.png"},79744:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321040319-80b049a54ee771132e7b00602a326ab1.png"},74848:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321041057-7898b81464d4abf08cb3bf0569a97d2e.png"},1211:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321041359-ca7dc7bcb82b41d82fd331aff9fd4b61.png"},96073:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220321041639-46b26836568451f62e15aaf7de73a9dc.png"}}]);