"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[6238],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return f}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),f=r,m=d["".concat(s,".").concat(f)]||d[f]||u[f]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},96694:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),i=["components"],l={tags:["File upload","XXE"],image:"https://cdn.acunetix.com/wp-content/uploads/2017/07/11110651/XXE_600x315.png"},s=void 0,c={unversionedId:"portswigger/XXE/XXE-attacks-via-file-upload",id:"portswigger/XXE/XXE-attacks-via-file-upload",title:"XXE-attacks-via-file-upload",description:"XXE attacks via file upload",source:"@site/docs/portswigger/XXE/XXE-attacks-via-file-upload.md",sourceDirName:"portswigger/XXE",slug:"/portswigger/XXE/XXE-attacks-via-file-upload",permalink:"/Cybernotes/docs/portswigger/XXE/XXE-attacks-via-file-upload",tags:[{label:"File upload",permalink:"/Cybernotes/docs/tags/file-upload"},{label:"XXE",permalink:"/Cybernotes/docs/tags/xxe"}],version:"current",frontMatter:{tags:["File upload","XXE"],image:"https://cdn.acunetix.com/wp-content/uploads/2017/07/11110651/XXE_600x315.png"},sidebar:"tutorialSidebar",previous:{title:"XInclude-Attacks",permalink:"/Cybernotes/docs/portswigger/XXE/XInclude-Attacks"}},p=[{value:"XXE attacks via file upload",id:"xxe-attacks-via-file-upload",children:[],level:2},{value:"Challenge",id:"challenge",children:[],level:2}],u={toc:p};function d(e){var t=e.components,l=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"xxe-attacks-via-file-upload"},"XXE attacks via file upload"),(0,o.kt)("p",null,"Some applications allow users to upload files which are then processed server-side. Some common file formats use XML or contain XML subcomponents. Examples of XML-based formats are office document formats like DOCX and image formats like SVG."),(0,o.kt)("p",null,"For example, an application might allow users to upload images, and process or validate these on the server after they are uploaded. Even if the application expects to receive a format like PNG or JPEG, the image processing library that is being used might support SVG images. Since the SVG format uses XML, an attacker can submit a malicious SVG image and so reach hidden attack surface for XXE vulnerabilities."),(0,o.kt)("h2",{id:"challenge"},"Challenge"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"This lab lets users attach avatars to comments and uses the Apache Batik library to process avatar image files.\nTo solve the lab, upload an image that displays the contents of the ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/hostname"),' file after processing. Then use the "Submit solution" button to submit the value of the server hostname.')),(0,o.kt)("p",null,"--\x3e So i googled for ",(0,o.kt)("inlineCode",{parentName:"p"},"Apache Batik Svg XXE")," and i found one blog which describes it in detail. You can find it ",(0,o.kt)("a",{parentName:"p",href:"https://insinuator.net/2015/03/xxe-injection-in-apache-batik-library-cve-2015-0250/"},"here")),(0,o.kt)("p",null,"So i just made one svg file and added this payload in it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'<?xml version="1.0" standalone="yes"?><!DOCTYPE ernw [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="800px" height="200px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-family="Verdana" font-size="60" x="10" y="40">&xxe;</text></svg>\n')),(0,o.kt)("p",null,"Save this file as ",(0,o.kt)("inlineCode",{parentName:"p"},"exploit.svg")),(0,o.kt)("p",null,"--\x3e I have changed ",(0,o.kt)("inlineCode",{parentName:"p"},"width"),",",(0,o.kt)("inlineCode",{parentName:"p"},"height")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"font-size")," because the output was not visible correctly."),(0,o.kt)("p",null,"So now goto any blog post and post comment and add ",(0,o.kt)("inlineCode",{parentName:"p"},"exploit.svg")," as avatar image."),(0,o.kt)("p",null,"After that goto source code and click image link and you will see the output of ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/hostname")," in image!"),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(38042).Z,width:"955",height:"547"})),(0,o.kt)("p",null,"And we solved the lab!"))}d.isMDXComponent=!0},38042:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220303133040-914fc05462b54fd617f4ff39e6434529.png"}}]);