"use strict";(self.webpackChunkcybersec_notes=self.webpackChunkcybersec_notes||[]).push([[8516],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),u=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(n),h=a,m=d["".concat(o,".").concat(h)]||d[h]||c[h]||l;return n?r.createElement(m,i(i({ref:t},p),{},{components:n})):r.createElement(m,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=d;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var u=2;u<l;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},97829:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return o},metadata:function(){return u},assets:function(){return p},toc:function(){return c},default:function(){return h}});var r=n(87462),a=n(63366),l=(n(67294),n(3905)),i=["components"],s={slug:"troll-1",title:"Vulnhub troll-1 writeup",description:"writeup of troll-1 machine from vulnhub",authors:["shivam"],image:"/img/Vulnhub/troll-1.jpg",tags:["wireshark","hydra","strings","kernel"]},o=void 0,u={permalink:"/Cybernotes/blog/troll-1",source:"@site/blog/2022-02-27-troll1/index.md",title:"Vulnhub troll-1 writeup",description:"writeup of troll-1 machine from vulnhub",date:"2022-02-27T00:00:00.000Z",formattedDate:"February 27, 2022",tags:[{label:"wireshark",permalink:"/Cybernotes/blog/tags/wireshark"},{label:"hydra",permalink:"/Cybernotes/blog/tags/hydra"},{label:"strings",permalink:"/Cybernotes/blog/tags/strings"},{label:"kernel",permalink:"/Cybernotes/blog/tags/kernel"}],readingTime:2.855,truncated:!0,authors:[{name:"0xSH1V4M",title:"Author",url:"https://github.com/shivam1317",imageURL:"https://avatars.githubusercontent.com/u/70281451?v=4",key:"shivam"}],frontMatter:{slug:"troll-1",title:"Vulnhub troll-1 writeup",description:"writeup of troll-1 machine from vulnhub",authors:["shivam"],image:"/img/Vulnhub/troll-1.jpg",tags:["wireshark","hydra","strings","kernel"]},prevItem:{title:"HTB Spider writeup",permalink:"/Cybernotes/blog/spider"},nextItem:{title:"THM Develpy writeup",permalink:"/Cybernotes/blog/develpy"}},p={authorsImageUrls:[void 0]},c=[{value:"Nmap results",id:"nmap-results",children:[],level:2},{value:"dirsearch results",id:"dirsearch-results",children:[],level:2},{value:"basic enumration",id:"basic-enumration",children:[],level:2},{value:"More enumration",id:"more-enumration",children:[],level:2},{value:"brute force",id:"brute-force",children:[],level:2},{value:"privesc",id:"privesc",children:[],level:2}],d={toc:c};function h(e){var t=e.components,s=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,r.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Hello everyone,"),(0,l.kt)("p",null,"Today we are going to solve troll-1 machine from vulnhub. This machine is full of rabbit holes and you have to think like noob xD. we will learn about\nwireshark,hydra and linux kernel privilege escalation"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(21129).Z,width:"720",height:"450"})),(0,l.kt)("h2",{id:"nmap-results"},"Nmap results"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"PORT STATE SERVICE VERSION\n21/tcp open ftp vsftpd 3.0.2\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rwxrwxrwx 1 1000 0 8068 Aug 10 2014 lol.pcap [NSE: writeable]\n| ftp-syst:\n| STAT:\n| FTP server status:\n| Connected to 10.0.2.15\n| Logged in as ftp\n| TYPE: ASCII\n| No session bandwidth limit\n| Session timeout in seconds is 600\n| Control connection is plain text\n| Data connections will be plain text\n| At session startup, client count was 2\n| vsFTPd 3.0.2 - secure, fast, stable\n|\\_End of status\n22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n| 1024 d6:18:d9:ef:75:d3:1c:29:be:14:b5:2b:18:54:a9:c0 (DSA)\n| 2048 ee:8c:64:87:44:39:53:8c:24:fe:9d:39:a9:ad:ea:db (RSA)\n| 256 0e:66:e6:50:cf:56:3b:9c:67:8b:5f:56:ca:ae:6b:f4 (ECDSA)\n|_ 256 b2:8b:e2:46:5c:ef:fd:dc:72:f7:10:7e:04:5f:25:85 (ED25519)\n80/tcp open http Apache httpd 2.4.7 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry\n|\\_/secret\n|\\_http-server-header: Apache/2.4.7 (Ubuntu)\n|\\_http-title: Site doesn't have a title (text/html).\nMAC Address: 08:00:27:CE:7F:DC (Oracle VirtualBox virtual NIC)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n")),(0,l.kt)("h2",{id:"dirsearch-results"},"dirsearch results"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[08:55:48] 200 - 36B - /index.html\n[08:55:50] 200 - 31B - /robots.txt\n[08:55:50] 301 - 306B - /secret -> http://10.0.2.17/secret/ > [08:55:50] 403 - 289B - /server-status\n")),(0,l.kt)("h2",{id:"basic-enumration"},"basic enumration"),(0,l.kt)("p",null,"--\x3e got this in /robots.txt"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"User-agent:*\nDisallow: /secret\n")),(0,l.kt)("p",null,"--\x3e got this in /secret directory"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(94937).Z,width:"919",height:"557"})),(0,l.kt)("p",null,"--\x3e also FTP anonymous login allowed so i went there and found one file called ",(0,l.kt)("inlineCode",{parentName:"p"},"lol.pcap")),(0,l.kt)("p",null,"--\x3e found many packets in that file but i found one interesting file called ",(0,l.kt)("strong",{parentName:"p"},"secret_stuff.txt")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(99816).Z,width:"1665",height:"769"})),(0,l.kt)("p",null,"--\x3e i also found one directory called ",(0,l.kt)("strong",{parentName:"p"},"sup3rscr3tdirlol ")),(0,l.kt)("p",null,"--\x3e i found one file in this directory"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(92783).Z,width:"583",height:"299"})),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"more-enumration"},"More enumration"),(0,l.kt)("p",null,"--\x3e i done ",(0,l.kt)("strong",{parentName:"p"},"strings roflmao")," and found that it's running a C file so Let's try to locate it!"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(26351).Z,width:"693",height:"855"})),(0,l.kt)("p",null,"--\x3e i fount this word ",(0,l.kt)("strong",{parentName:"p"},"0x0856BF")," in that file when i executed it and i tried to decode it but it was actully a directory !"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(25719).Z,width:"755",height:"287"})),(0,l.kt)("p",null,"--\x3e it's a directory"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(86297).Z,width:"1025",height:"451"})),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"brute-force"},"brute force"),(0,l.kt)("p",null,"==> i found this in ",(0,l.kt)("strong",{parentName:"p"},"pass.txt")," file :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"Good_job_:)\n")),(0,l.kt)("p",null,"==> i found this in ",(0,l.kt)("strong",{parentName:"p"},"which_one_lol.txt")," file:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"maleus\nps-aux\nfelux\nEagle11\ngenphlux < -- Definitely not this one\nusmc8892\nblawrg\nwytshadow\nvis1t0r\noverflow\n")),(0,l.kt)("p",null,"--\x3e i tried this above password for all the users using hydra but i didn't get any results"),(0,l.kt)("p",null,"==> so for this part i had to see a writeup and actully the password was the name of password file itself which was ",(0,l.kt)("strong",{parentName:"p"},"Pass.txt")," xD"),(0,l.kt)("p",null,"--\x3e so i brute forced this password for all users using command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"hydra -L users.txt -P pass.txt <ip> ssh\n")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(18808).Z,width:"1323",height:"459"})),(0,l.kt)("p",null,"--\x3e and we got ssh shell !\n--\x3eLet's escalate our privilleges !"),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"privesc"},"privesc"),(0,l.kt)("p",null,"--\x3e i tried to do ",(0,l.kt)("strong",{parentName:"p"},"sudo -l")," but permission was denied so i tried to find some SUID bits but there was not any ."),(0,l.kt)("p",null,"--\x3e at last i run linpeas and found linux kernel vulnerable !"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(77437).Z,width:"981",height:"379"})),(0,l.kt)("p",null,"--\x3e and also i only have write permission in ",(0,l.kt)("strong",{parentName:"p"},"/tmp")),(0,l.kt)("p",null,"==> so Let's search exploit for this !"),(0,l.kt)("p",null,"--\x3e and i found one on exploit-db"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(44926).Z,width:"1903",height:"539"})),(0,l.kt)("p",null,"--\x3e so Let's download it in victim machine and execute it !"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},"gcc exploit.c\n./a.out\n")),(0,l.kt)("p",null,"--\x3e and i got ",(0,l.kt)("inlineCode",{parentName:"p"},"root")," shell !"),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(17977).Z,width:"925",height:"940"})),(0,l.kt)("hr",null))}h.isMDXComponent=!0},94937:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703090555-4e7bbc2eb54599c15b21204546a93461.png"},99816:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703093614-93693b347410e1b4dbdaeb879e7f5608.png"},92783:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703093723-98c4d9213fc2164de60015cba83a6317.png"},26351:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703094313-d34f708473852b837a82f2a06131b9a8.png"},25719:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703095009-3846e5c52af13228454b7efad1d2cb86.png"},86297:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703100105-61981e49f584fe3a3b9e3bffd4d32ad0.png"},18808:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703104504-b88f858c5abf8e3cb2757b4e82e58241.png"},17977:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703111916-6e0095f07230704c697716d182d74ee7.png"},77437:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703112317-ca7708f676bbc3041d2853242d9ac8ce.png"},44926:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20210703112441-aba298410c40f5f909fdf6b37ca09dd1.png"},21129:function(e,t,n){t.Z=n.p+"assets/images/troll-1-d23d2ddcbee4c52dc2868893519e75e2.jpg"}}]);