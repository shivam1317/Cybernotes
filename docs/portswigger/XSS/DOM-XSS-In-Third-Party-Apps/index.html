<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/Cybernotes/blog/rss.xml" title="Cybernotes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cybernotes/blog/atom.xml" title="Cybernotes Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Cybernotes" href="/Cybernotes/opensearch.xml"><title data-react-helmet="true">DOM-XSS-In-Third-Party-Apps | Cybernotes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://shivam1317.github.io/Cybernotes/docs/portswigger/XSS/DOM-XSS-In-Third-Party-Apps"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="google-site-verification" content="QR87sedAl37ED2yeGmgSmXKX6r3GfBffBjunkUFl0rI"><meta data-react-helmet="true" property="og:title" content="DOM-XSS-In-Third-Party-Apps | Cybernotes"><meta data-react-helmet="true" name="description" content="Sources and sinks in third-party dependencies"><meta data-react-helmet="true" property="og:description" content="Sources and sinks in third-party dependencies"><meta data-react-helmet="true" property="og:image" content="https://www.cloudflare.com/img/learning/security/threats/cross-site-scripting/xss-attack.png"><meta data-react-helmet="true" name="twitter:image" content="https://www.cloudflare.com/img/learning/security/threats/cross-site-scripting/xss-attack.png"><link data-react-helmet="true" rel="icon" href="/Cybernotes/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/XSS/DOM-XSS-In-Third-Party-Apps"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/XSS/DOM-XSS-In-Third-Party-Apps" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/XSS/DOM-XSS-In-Third-Party-Apps" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://ABHJYS7Q6I-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Cybernotes/assets/css/styles.b0445982.css">
<link rel="preload" href="/Cybernotes/assets/js/runtime~main.3f3644df.js" as="script">
<link rel="preload" href="/Cybernotes/assets/js/main.6f91976f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Cybernotes/"><div class="navbar__logo"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cybernotes</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Cybernotes/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/Cybernotes/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shivam1317/Cybernotes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_Pssr toggle_TdHA toggleChecked_cnQY toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" checked="" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/Cybernotes/docs/intro">Welcome</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/Cybernotes/docs/portswigger/Authentication/Brute-force attacks">Portswigger labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Authentication/Brute-force attacks">Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Business-logic/Lab-1 Excessive-trust-in-client-side-controls">Business-logic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Directory-traversal/Lab-1">Directory-traversal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Command-Injection/Intro">Command-Injection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/File-upload/Lab-1 Unrestricted-file-uploads">File-upload</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Information-disclosure/Lab-1 Error messages">Information-disclosure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Sql-injection/Blind Sqli with out-of-band interaction">Sql-injection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/Blind SSRF">SSRF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Intro">XSS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/XSS-Lab-2">XSS-Lab-2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/XSS-Lab-3">XSS-Lab-3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Reflected-XSS">Reflected XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Reflected-XSS-with-some-SVG-markup-allowed">Lab: Reflected XSS with some SVG markup allowed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Stored-XSS">Stored XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/DOM-XSS">DOM-XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/DOM-XSS-With-reflected-and-Stored-Data">DOM-XSS-With-reflected-and-Stored-Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/DOM-XSS-In-Third-Party-Apps">DOM-XSS-In-Third-Party-Apps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Content-Security-Policy">Content-Security-Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Exploiting-XSS-Vulnerabilities">Exploiting cross-site scripting vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Making-use-of-HTML-encoding">Making-use-of-HTML-encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/XSS-In-HTML-Tag-Attributes">XSS-In-HTML-Tag-Attributes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/XSS-Into-Javascript">XSS-Into-Javascript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/XSS-without-events">XSS-without-events</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/XXE/intro">XXE</a></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DOM-XSS-In-Third-Party-Apps</h1></header><h4 class="anchor anchorWithStickyNavbar_mojV" id="sources-and-sinks-in-third-party-dependencies">Sources and sinks in third-party dependencies<a class="hash-link" href="#sources-and-sinks-in-third-party-dependencies" title="Direct link to heading">â€‹</a></h4><p>Modern web applications are typically built using a number of third-party libraries and frameworks, which often provide additional functions and capabilities for developers. It&#x27;s important to remember that some of these are also potential sources and sinks for DOM XSS.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="dom-xss-in-jquery">DOM XSS in jQuery<a class="hash-link" href="#dom-xss-in-jquery" title="Direct link to heading">â€‹</a></h4><p>If a JavaScript library such as jQuery is being used, look out for sinks that can alter DOM elements on the page. For instance, jQuery&#x27;s <code>attr()</code> function can change the attributes of DOM elements. If data is read from a user-controlled source like the URL, then passed to the <code>attr()</code> function, then it may be possible to manipulate the value sent to cause XSS. For example, here we have some JavaScript that changes an anchor element&#x27;s <code>href</code> attribute using data from the URL:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;#backLink&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">attr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;href&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">URLSearchParams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token dom variable" style="color:rgb(214, 222, 235)">window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">location</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">search</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;returnUrl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can exploit this by modifying the URL so that the <code>location.search</code> source contains a malicious JavaScript URL. After the page&#x27;s JavaScript applies this malicious URL to the back link&#x27;s <code>href</code>, clicking on the back link will execute it:</p><p><code>?returnUrl=javascript:alert(document.domain)</code></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source">Lab: DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source<a class="hash-link" href="#lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source" title="Direct link to heading">â€‹</a></h2><blockquote><p>This lab contains a <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based" target="_blank" rel="noopener noreferrer">DOM-based cross-site scripting</a> vulnerability in the submit feedback page. It uses the jQuery library&#x27;s <code>$</code> selector function to find an anchor element, and changes its <code>href</code> attribute using data from <code>location.search</code>.
To solve this lab, make the &quot;back&quot; link alert <code>document.cookie</code>.</p></blockquote><p>--&gt; So we know that <code>returnPath</code> is vulnerable so i just changed it&#x27;s value in URL to <code>javascript:alert(document.domain)</code></p><p>And final url looks like this:</p><p><code>?returnPath=javascript:alert(document.domain)</code></p><p>And we solved the lab!</p><hr><p>Another potential sink to look out for is jQuery&#x27;s <code>$()</code> selector function, which can be used to inject malicious objects into the DOM.</p><p>jQuery used to be extremely popular, and a classic DOM XSS vulnerability was caused by websites using this selector in conjunction with the <code>location.hash</code> source for animations or auto-scrolling to a particular element on the page. This behavior was often implemented using a vulnerable <code>hashchange</code> event handler, similar to the following:</p><p><code>$(window).on(&#x27;hashchange&#x27;, function() { var element = $(location.hash); element[0].scrollIntoView(); });</code></p><p>As the <code>hash</code> is user controllable, an attacker could use this to inject an XSS vector into the <code>$()</code> selector sink. More recent versions of jQuery have patched this particular vulnerability by preventing you from injecting HTML into a selector when the input begins with a hash character (<code>#</code>). However, you may still find vulnerable code in the wild.</p><p>To actually exploit this classic vulnerability, you&#x27;ll need to find a way to trigger a <code>hashchange</code> event without user interaction. One of the simplest ways of doing this is to deliver your exploit via an <code>iframe</code>:</p><p><code>&lt;iframe src=&quot;https://vulnerable-website.com#&quot; onload=&quot;this.src+=&#x27;&lt;img src=1 onerror=alert(1)&gt;&#x27;&quot;&gt;</code></p><p>In this example, the <code>src</code> attribute points to the vulnerable page with an empty hash value. When the <code>iframe</code> is loaded, an XSS vector is appended to the hash, causing the <code>hashchange</code> event to fire.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="note">Note<a class="hash-link" href="#note" title="Direct link to heading">â€‹</a></h4><p>Even newer versions of jQuery can still be vulnerable via the <code>$()</code> selector sink, provided you have full control over its input from a source that doesn&#x27;t require a <code>#</code> prefix.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-event">Lab: DOM XSS in jQuery selector sink using a hashchange event<a class="hash-link" href="#lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-event" title="Direct link to heading">â€‹</a></h2><blockquote><p>This lab contains a <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based" target="_blank" rel="noopener noreferrer">DOM-based cross-site scripting</a> vulnerability on the home page. It uses jQuery&#x27;s <code>$()</code> selector function to auto-scroll to a given post, whose title is passed via the <code>location.hash</code> property.
To solve the lab, deliver an exploit to the victim that calls the <code>print()</code> function in their browser.</p></blockquote><p>--&gt; I went to exploit server and tried this payload:</p><div class="codeBlockContainer_I0IT language-html theme-code-block"><div class="codeBlockContent_wNvx html"><pre tabindex="0" class="prism-code language-html codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">iframe</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">LAB-URL/#</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag special-attr attr-name" style="color:rgb(173, 219, 103);font-style:italic">onload</span><span class="token tag special-attr attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag special-attr attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag special-attr attr-value value javascript language-javascript literal-property property" style="color:rgb(128, 203, 196)">javascript</span><span class="token tag special-attr attr-value value javascript language-javascript operator" style="color:rgb(127, 219, 202)">:</span><span class="token tag special-attr attr-value value javascript language-javascript function" style="color:rgb(130, 170, 255)">print</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token tag special-attr attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">iframe</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>But idk it didn&#x27;t worked :/ i also went to see the exploit and it was triggering the print function but portswigger labs will only show you solved status when you use their payload.</p><p>So after that i used that image payload which will trigger print function.</p><div class="codeBlockContainer_I0IT language-html theme-code-block"><div class="codeBlockContent_wNvx html"><pre tabindex="0" class="prism-code language-html codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">iframe</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">LAB-URL/#</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag special-attr attr-name" style="color:rgb(173, 219, 103);font-style:italic">onload</span><span class="token tag special-attr attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag special-attr attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag special-attr attr-value value javascript language-javascript keyword" style="color:rgb(127, 219, 202)">this</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token tag special-attr attr-value value javascript language-javascript property-access" style="color:rgb(127, 219, 202)">src</span><span class="token tag special-attr attr-value value javascript language-javascript operator" style="color:rgb(127, 219, 202)">+=</span><span class="token tag special-attr attr-value value javascript language-javascript string" style="color:rgb(173, 219, 103)">&#x27;&lt;img src=1 onerror=print()&gt;&#x27;</span><span class="token tag special-attr attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">&quot;&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">iframe</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>--&gt; Click <code>store</code> and then <code>deliver exploit to victim</code></p><p>And we solved the lab!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="dom-xss-in-angularjs">DOM XSS in <a href="https://portswigger.net/web-security/cross-site-scripting/contexts/angularjs-sandbox" target="_blank" rel="noopener noreferrer">AngularJS</a><a class="hash-link" href="#dom-xss-in-angularjs" title="Direct link to heading">â€‹</a></h2><p>If a framework like AngularJS is used, it may be possible to execute JavaScript without angle brackets or events. When a site uses the <code>ng-app</code> attribute on an HTML element, it will be processed by AngularJS. In this case, AngularJS will execute JavaScript inside double curly braces that can occur directly in HTML or inside attributes.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="lab-dom-xss-in-angularjs-expression-with-angle-brackets-and-double-quotes-html-encoded">Lab: DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded<a class="hash-link" href="#lab-dom-xss-in-angularjs-expression-with-angle-brackets-and-double-quotes-html-encoded" title="Direct link to heading">â€‹</a></h2><blockquote><p>This lab contains a <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based" target="_blank" rel="noopener noreferrer">DOM-based cross-site scripting</a> vulnerability in a <a href="https://portswigger.net/web-security/cross-site-scripting/contexts/angularjs-sandbox" target="_blank" rel="noopener noreferrer">AngularJS</a> expression within the search functionality.
AngularJS is a popular JavaScript library, which scans the contents of HTML nodes containing the <code>ng-app</code> attribute (also known as an AngularJS directive). When a directive is added to the HTML code, you can execute JavaScript expressions within double curly braces. This technique is useful when angle brackets are being encoded.
To solve this lab, perform a cross-site scripting attack that executes an AngularJS expression and calls the <code>alert</code> function.</p></blockquote><p>I searched for <code>DOM xss in angular with ng-app</code> and found some resources.</p><p>--&gt; I tried this payload and it worked!</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 139)">$on</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;alert(1)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Resources:</p><ul><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/XSS%20in%20Angular.md" target="_blank" rel="noopener noreferrer">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/XSS%20in%20Angular.md</a></li><li><a href="https://spring.io/blog/2016/01/28/angularjs-escaping-the-expression-sandbox-for-xss" target="_blank" rel="noopener noreferrer">https://spring.io/blog/2016/01/28/angularjs-escaping-the-expression-sandbox-for-xss</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Cybernotes/docs/tags/dom">DOM</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Cybernotes/docs/portswigger/XSS/DOM-XSS-With-reflected-and-Stored-Data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DOM-XSS-With-reflected-and-Stored-Data</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Cybernotes/docs/portswigger/XSS/Content-Security-Policy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Content-Security-Policy</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lab-dom-xss-in-jquery-anchor-href-attribute-sink-using-locationsearch-source" class="table-of-contents__link toc-highlight">Lab: DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source</a></li><li><a href="#lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-event" class="table-of-contents__link toc-highlight">Lab: DOM XSS in jQuery selector sink using a hashchange event</a></li><li><a href="#dom-xss-in-angularjs" class="table-of-contents__link toc-highlight">DOM XSS in AngularJS</a></li><li><a href="#lab-dom-xss-in-angularjs-expression-with-angle-brackets-and-double-quotes-html-encoded" class="table-of-contents__link toc-highlight">Lab: DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Cybernotes/docs/contributing">How to contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact me</div><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/@0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/wXQAxT8X9d" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://oxsh1v4m.gitbook.io/webdev-notes/getting-started/welcome" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Development notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/shivam1317" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Cybernotes</div></div></div></footer></div>
<script src="/Cybernotes/assets/js/runtime~main.3f3644df.js"></script>
<script src="/Cybernotes/assets/js/main.6f91976f.js"></script>
</body>
</html>