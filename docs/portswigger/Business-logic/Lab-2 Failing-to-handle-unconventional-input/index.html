<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/Cybernotes/blog/rss.xml" title="Cybernotes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cybernotes/blog/atom.xml" title="Cybernotes Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Cybernotes" href="/Cybernotes/opensearch.xml"><title data-react-helmet="true">Lab-2 Failing-to-handle-unconventional-input | Cybernotes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://shivam1317.github.io/Cybernotes/img/book.png"><meta data-react-helmet="true" name="twitter:image" content="https://shivam1317.github.io/Cybernotes/img/book.png"><meta data-react-helmet="true" property="og:url" content="https://shivam1317.github.io/Cybernotes/docs/portswigger/Business-logic/Lab-2 Failing-to-handle-unconventional-input"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="google-site-verification" content="QR87sedAl37ED2yeGmgSmXKX6r3GfBffBjunkUFl0rI"><meta data-react-helmet="true" property="og:title" content="Lab-2 Failing-to-handle-unconventional-input | Cybernotes"><meta data-react-helmet="true" name="description" content="Failing to handle unconventional input"><meta data-react-helmet="true" property="og:description" content="Failing to handle unconventional input"><link data-react-helmet="true" rel="icon" href="/Cybernotes/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/Business-logic/Lab-2 Failing-to-handle-unconventional-input"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/Business-logic/Lab-2 Failing-to-handle-unconventional-input" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/Business-logic/Lab-2 Failing-to-handle-unconventional-input" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://ABHJYS7Q6I-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Cybernotes/assets/css/styles.b0445982.css">
<link rel="preload" href="/Cybernotes/assets/js/runtime~main.7c4acbde.js" as="script">
<link rel="preload" href="/Cybernotes/assets/js/main.ba890b6c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Cybernotes/"><div class="navbar__logo"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cybernotes</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Cybernotes/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/Cybernotes/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shivam1317/Cybernotes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_Pssr toggle_TdHA toggleChecked_cnQY toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" checked="" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/Cybernotes/docs/intro">Welcome</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/Cybernotes/docs/portswigger/Authentication/Brute-force attacks">Portswigger labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Authentication/Brute-force attacks">Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/Cybernotes/docs/portswigger/Business-logic/Lab-1 Excessive-trust-in-client-side-controls">Business-logic</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/Business-logic/Lab-1 Excessive-trust-in-client-side-controls">Lab-1 Excessive-trust-in-client-side-controls</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Cybernotes/docs/portswigger/Business-logic/Lab-2 Failing-to-handle-unconventional-input">Lab-2 Failing-to-handle-unconventional-input</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Command-Injection/Intro">Command-Injection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Directory-traversal/Lab-1">Directory-traversal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/File-upload/Lab-1 Unrestricted-file-uploads">File-upload</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Information-disclosure/Lab-1 Error messages">Information-disclosure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Sql-injection/Blind Sqli with out-of-band interaction">Sql-injection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/Blind SSRF">SSRF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Intro">XSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/XXE/intro">XXE</a></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lab-2 Failing-to-handle-unconventional-input</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="failing-to-handle-unconventional-input">Failing to handle unconventional input<a class="hash-link" href="#failing-to-handle-unconventional-input" title="Direct link to heading">â€‹</a></h2><p>One aim of the application logic is to restrict user input to values that adhere to the business rules. For example, the application may be designed to accept arbitrary values of a certain data type, but the logic determines whether or not this value is acceptable from the perspective of the business. Many applications incorporate numeric limits into their logic. This might include limits designed to manage inventory, apply budgetary restrictions, trigger phases of the supply chain, and so on.</p><p>Let&#x27;s take the simple example of an online shop. When ordering products, users typically specify the quantity that they want to order. Although any integer is theoretically a valid input, the business logic might prevent users from ordering more units than are currently in stock, for example.</p><p>To implement rules like this, developers need to anticipate all possible scenarios and incorporate ways to handle them into the application logic. In other words, they need to tell the application whether it should allow a given input and how it should react based on various conditions. If there is no explicit logic for handling a given case, this can lead to unexpected and potentially exploitable behavior.</p><p>For example, a numeric data type might accept negative values. Depending on the related functionality, it may not make sense for the business logic to allow this. However, if the application doesn&#x27;t perform adequate server-side validation and reject this input, an attacker may be able to pass in a negative value and induce unwanted behavior.</p><p>Consider a funds transfer between two bank accounts. This functionality will almost certainly check whether the sender has sufficient funds before completing the transfer:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">$transferAmount = $_POST[&#x27;amount&#x27;];</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">$currentBalance = $user-&gt;getBalance();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">if ($transferAmount &lt;= $currentBalance) {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Â Â Â Â // Complete the transfer</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">} else {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Â Â Â Â // Block the transfer: insufficient funds</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>But if the logic doesn&#x27;t sufficiently prevent users from supplying a negative value in the <code>amount</code> parameter, this could be exploited by an attacker to both bypass the balance check and transfer funds in the &quot;wrong&quot; direction. If the attacker sent -$1000 to the victim&#x27;s account, this might result in them receiving $1000 from the victim instead. The logic would always evaluate that -1000 is less than the current balance and approve the transfer.</p><p>Simple logic flaws like this can be devastating if they occur in the right functionality. They are also easy to miss during both development and testing, especially given that such inputs may be blocked by client-side controls on the web interface.</p><p>When auditing an application, you should use tools such as Burp Proxy and Repeater to try submitting unconventional values. In particular, try input in ranges that legitimate users are unlikely to ever enter. This includes exceptionally high or exceptionally low numeric inputs and abnormally long strings for text-based fields. You can even try unexpected data types. By observing the application&#x27;s response, you should try and answer the following questions:</p><ul><li>Are there any limits that are imposed on the data?</li><li>What happens when you reach those limits?</li><li>Is any transformation or normalization being performed on your input?</li></ul><p>This may expose weak input validation that allows you to manipulate the application in unusual ways. Keep in mind that if you find one form on the target website that fails to safely handle unconventional input, it&#x27;s likely that other forms will have the same issues.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="challenge">Challenge<a class="hash-link" href="#challenge" title="Direct link to heading">â€‹</a></h2><blockquote><p>This lab doesn&#x27;t adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a &quot;Lightweight l33t leather jacket&quot;.
You can log in to your own account using the following credentials: <code>wiener:peter</code></p></blockquote><p>--&gt; I bought the <code>l33t</code> jacket with 1337$ and bought the other item with the negative quantity to make the final value positive !</p><p>And after placing the order i solved the lab!</p><p><img src="/Cybernotes/assets/images/Pastedimage20220126132933-1bc27d65ecde6bd956da30e33b1a66ce.png" width="1683" height="719"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="challenge-2">Challenge 2<a class="hash-link" href="#challenge-2" title="Direct link to heading">â€‹</a></h2><p>--&gt; So first i intercepted the request of buying the jacket and changed the quantity to <code>100</code> and i got the error !</p><p><img src="/Cybernotes/assets/images/Pastedimage20220128124905-6a8b7a5f48882efa269f90436571fd60.png" width="1881" height="715"></p><p>--&gt; So it means we can&#x27;t add the 3 digit value. so after that i tried with <code>99</code>and it worked!</p><p><img src="/Cybernotes/assets/images/Pastedimage20220128125311-6f99721e28425d2f019f2758e09cfae1.png" width="1627" height="747"></p><p>--&gt; Now send this request to intruder and change the <code>quantity</code> to 99 and select the Payload type to <code>Null payloads</code> and select the Continue idenfinitely</p><p>And after some time the backend will reach the maximum integer limit and convert it into negative value and we will get negative value in checkout</p><p><img src="/Cybernotes/assets/images/Pastedimage20220128131744-736f805ae78d1f00a4474e2f7f280d56.png" width="885" height="619"></p><p>--&gt; But now settling this is very hard so that they gave us one number which whill generate the checkout price near to 0 and that number is <code>323</code></p><p>Just change the value of payloads in <code>payloads</code> option</p><blockquote><p>Note:Clear your cart before running the second attack!</p></blockquote><p><img src="/Cybernotes/assets/images/Pastedimage20220128131941-cae8ea2735370d35945b87ae7527e7e7.png" width="1403" height="799"></p><p>--&gt; And now start the attack and wait for attack to finish!</p><p>Now you will still get one big negative number so now goto repeater and set the value of quantity for jacket as <code>47</code> and send the request and if value is still big then try to send more request with <code>99</code> quantity.</p><p>And finally you will get one value like this which is easy to settle.</p><p><img src="/Cybernotes/assets/images/Pastedimage20220128132521-c675a1417e1bfe726388dfe20fea37bb.png" width="1037" height="766"></p><p>--&gt; I bought some other items with positive value to make the final value positive and now we can buy this!</p><p><img src="/Cybernotes/assets/images/Pastedimage20220128132807-5de7e56b0ae74713e3dabd67b6501f44.png" width="1157" height="832"></p><p>--&gt; And we solved the lab!</p><p><img src="/Cybernotes/assets/images/Pastedimage20220128133415-0c0f1a5384bc9c331af854e1853b9cb4.png" width="1499" height="619"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Cybernotes/docs/tags/business-logic">business logic</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Cybernotes/docs/tags/negative-value">negative value</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Cybernotes/docs/portswigger/Business-logic/Lab-1 Excessive-trust-in-client-side-controls"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab-1 Excessive-trust-in-client-side-controls</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Cybernotes/docs/portswigger/Command-Injection/Intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">What is OS command injection?</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#failing-to-handle-unconventional-input" class="table-of-contents__link toc-highlight">Failing to handle unconventional input</a></li><li><a href="#challenge" class="table-of-contents__link toc-highlight">Challenge</a></li><li><a href="#challenge-2" class="table-of-contents__link toc-highlight">Challenge 2</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Cybernotes/docs/contributing">How to contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact me</div><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/@0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/wXQAxT8X9d" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://oxsh1v4m.gitbook.io/webdev-notes/getting-started/welcome" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Development notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/shivam1317" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Cybernotes</div></div></div></footer></div>
<script src="/Cybernotes/assets/js/runtime~main.7c4acbde.js"></script>
<script src="/Cybernotes/assets/js/main.ba890b6c.js"></script>
</body>
</html>