<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/Cybernotes/blog/rss.xml" title="Cybernotes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cybernotes/blog/atom.xml" title="Cybernotes Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Cybernotes" href="/Cybernotes/opensearch.xml"><title data-react-helmet="true">SSRF-attacks-against-the-server-itself | Cybernotes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://shivam1317.github.io/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-the-server-itself"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="google-site-verification" content="QR87sedAl37ED2yeGmgSmXKX6r3GfBffBjunkUFl0rI"><meta data-react-helmet="true" property="og:title" content="SSRF-attacks-against-the-server-itself | Cybernotes"><meta data-react-helmet="true" name="description" content="SSRF attacks against the server itself"><meta data-react-helmet="true" property="og:description" content="SSRF attacks against the server itself"><meta data-react-helmet="true" property="og:image" content="https://shivam1317.github.io/Cybernotes/img/Portswigger/SSRF.png"><meta data-react-helmet="true" name="twitter:image" content="https://shivam1317.github.io/Cybernotes/img/Portswigger/SSRF.png"><link data-react-helmet="true" rel="icon" href="/Cybernotes/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-the-server-itself"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-the-server-itself" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-the-server-itself" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://ABHJYS7Q6I-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Cybernotes/assets/css/styles.b0445982.css">
<link rel="preload" href="/Cybernotes/assets/js/runtime~main.9978a6cd.js" as="script">
<link rel="preload" href="/Cybernotes/assets/js/main.f99982ba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Cybernotes/"><div class="navbar__logo"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cybernotes</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Cybernotes/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/Cybernotes/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shivam1317/Cybernotes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_Pssr toggle_TdHA toggleChecked_cnQY toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" checked="" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/Cybernotes/docs/intro">Welcome</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/Cybernotes/docs/portswigger/Authentication/Brute-force attacks">Portswigger labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Authentication/Brute-force attacks">Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Command-Injection/Intro">Command-Injection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Business-logic/Lab-1 Excessive-trust-in-client-side-controls">Business-logic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Directory-traversal/Lab-1">Directory-traversal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/File-upload/Lab-1 Unrestricted-file-uploads">File-upload</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Information-disclosure/Lab-1 Error messages">Information-disclosure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/Sql-injection/Blind Sqli with out-of-band interaction">Sql-injection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/Blind SSRF">SSRF</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/Blind SSRF">Blind SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/Bypassing-SSRF-filters-via-open-redirection">Bypassing-SSRF-filters-via-open-redirection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/Intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/SSRF-and-Shellshock">SSRF-and-Shellshock</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-other-back-end-systems">SSRF-attacks-against-other-back-end-systems</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-the-server-itself">SSRF-attacks-against-the-server-itself</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/SSRF-with-blacklist-based-input-filters">SSRF-with-blacklist-based-input-filters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Cybernotes/docs/portswigger/SSRF/SSRF-with-whitelist-based-input-filters">SSRF-with-whitelist-based-input-filters</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/XSS/Intro">XSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/Cybernotes/docs/portswigger/XXE/intro">XXE</a></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SSRF-attacks-against-the-server-itself</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="ssrf-attacks-against-the-server-itself">SSRF attacks against the server itself<a class="hash-link" href="#ssrf-attacks-against-the-server-itself" title="Direct link to heading">â€‹</a></h2><p>In an SSRF attack against the server itself, the attacker induces the application to make an HTTP request back to the server that is hosting the application, via its loopback network interface. This will typically involve supplying a URL with a hostname like <code>127.0.0.1</code> (a reserved IP address that points to the loopback adapter) or <code>localhost</code> (a commonly used name for the same adapter).</p><p>For example, consider a shopping application that lets the user view whether an item is in stock in a particular store. To provide the stock information, the application must query various back-end REST APIs, dependent on the product and store in question. The function is implemented by passing the URL to the relevant back-end API endpoint via a front-end HTTP request. So when a user views the stock status for an item, their browser makes a request like this:</p><p><code>POST /product/stock HTTP/1.0 Content-Type: application/x-www-form-urlencoded Content-Length: 118 stockApi=http://stock.weliketoshop.net:8080/product/stock/check%3FproductId%3D6%26storeId%3D1</code></p><p>This causes the server to make a request to the specified URL, retrieve the stock status, and return this to the user.</p><p>In this situation, an attacker can modify the request to specify a URL local to the server itself. For example:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">POST /product/stock HTTP/1.0</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Content-Type: application/x-www-form-urlencoded Content-Length: 118 stockApi=http://localhost/admin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here, the server will fetch the contents of the <code>/admin</code> URL and return it to the user.</p><p>Now of course, the attacker could just visit the <code>/admin</code> URL directly. But the administrative functionality is ordinarily accessible only to suitable authenticated users. So an attacker who simply visits the URL directly won&#x27;t see anything of interest. However, when the request to the <code>/admin</code> URL comes from the local machine itself, the normal <a href="https://portswigger.net/web-security/access-control" target="_blank" rel="noopener noreferrer">access controls</a> are bypassed. The application grants full access to the administrative functionality, because the request appears to originate from a trusted location.</p><p>Why do applications behave in this way, and implicitly trust requests that come from the local machine? This can arise for various reasons:</p><ul><li>The <a href="https://portswigger.net/web-security/access-control" target="_blank" rel="noopener noreferrer">access control</a> check might be implemented in a different component that sits in front of the application server. When a connection is made back to the server itself, the check is bypassed.</li><li>For disaster recovery purposes, the application might allow administrative access without logging in, to any user coming from the local machine. This provides a way for an administrator to recover the system in the event they lose their credentials. The assumption here is that only a fully trusted user would be coming directly from the server itself.</li><li>The administrative interface might be listening on a different port number than the main application, and so might not be reachable directly by users.</li></ul><p>These kind of trust relationships, where requests originating from the local machine are handled differently than ordinary requests, is often what makes SSRF into a critical vulnerability.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="challenge">Challenge<a class="hash-link" href="#challenge" title="Direct link to heading">â€‹</a></h2><p>--&gt; So in this challenge we have to delete the <code>carlos</code>&#x27;s account by performing SSRF in check stock request.</p><p>So i intercepted check stock request and changed the stockApi value to <code>http://localhost/admin</code></p><p><img src="/Cybernotes/assets/images/Pastedimage20220220083700-85b2ad5b6ddffd2ca1543f01e0eeb5f1.png" width="1235" height="599"></p><p>--&gt; And i got the admin panel!</p><p><img src="/Cybernotes/assets/images/Pastedimage20220220083610-5bd2df397a1b2fcb0540e9ccfc658b5d.png" width="1351" height="495"></p><p>But whenever we click on something then i was getting the below error.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">Admin interface only available if logged in as an administrator, or if requested from loopback</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>So After that i intercepted the user deleting request and added it in stockApi and i solved the lab!</p><p><img src="/Cybernotes/assets/images/Pastedimage20220220084149-04b52b22575535012d7007f805c39bb4.png" width="1339" height="491"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Cybernotes/docs/portswigger/SSRF/SSRF-attacks-against-other-back-end-systems"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SSRF-attacks-against-other-back-end-systems</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Cybernotes/docs/portswigger/SSRF/SSRF-with-blacklist-based-input-filters"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SSRF-with-blacklist-based-input-filters</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ssrf-attacks-against-the-server-itself" class="table-of-contents__link toc-highlight">SSRF attacks against the server itself</a></li><li><a href="#challenge" class="table-of-contents__link toc-highlight">Challenge</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Cybernotes/docs/contributing">How to contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact me</div><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/@0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/wXQAxT8X9d" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://oxsh1v4m.gitbook.io/webdev-notes/getting-started/welcome" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Development notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/shivam1317" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Cybernotes</div></div></div></footer></div>
<script src="/Cybernotes/assets/js/runtime~main.9978a6cd.js"></script>
<script src="/Cybernotes/assets/js/main.f99982ba.js"></script>
</body>
</html>